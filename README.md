# &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;汇编语言期末项目 
## &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;---------- 1552662 方炜豪 
## &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;---------- Conway's game of life
## 项目介绍
##### 生命游戏是英国数学家约翰·何顿·康威在1970年发明的细胞自动机。它最初于1970年10月在《科学美国人》杂志中马丁·葛登能（Martin Gardner，1914年11月21日－2010年5月22日。又译：马丁·加德纳）的“数学游戏”专栏出现。
##### 生命游戏其实是一个零玩家游戏，它包括一个二维矩形世界，这个世界中的每个方格居住着一个活着的或死了的细胞。一个细胞在下一个时刻生死取决于相邻八个方格中活着的或死了的细胞的数量。如果相邻方格活着的细胞数量过多，这个细胞会因为资源匮乏而在下一个时刻死去；相反，如果周围活细胞过少，这个细胞会因太孤单而死去。实际中，你可以设定周围活细胞的数目怎样时才适宜该细胞的生存。如果这个数目设定过低，世界中的大部分细胞会因为找不到太多的活的邻居而死去，直到整个世界都没有生命；如果这个数目设定过高，世界中又会被生命充满而没有什么变化。实际中，这个数目一般选取2或者3；这样整个生命世界才不至于太过荒凉或拥挤，而是一种动态的平衡。这样的话，游戏的规则就是：当一个方格周围有2或3个活细胞时，方格中的活细胞在下一个时刻继续存活；即使这个时刻方格中没有活细胞，在下一个时刻也会“诞生”活细胞。在这个游戏中，还可以设定一些更加复杂的规则，例如当前方格的状况不仅由父一代决定，而且还考虑祖父一代的情况。你还可以作为这个世界的上帝，随意设定某个方格细胞的死活，以观察对世界的影响。
##### 在游戏的进行中，杂乱无序的细胞会逐渐演化出各种精致、有形的结构；这些结构往往有很好的对称性，而且每一代都在变化形状。一些形状已经锁定，不会逐代变化。有时，一些已经成形的结构会因为一些无序细胞的“入侵”而被破坏。但是形状和秩序经常能从杂乱中产生出来。
![](https://github.com/fangweihao123/Photo-Repo/raw/master/gol_1.jpg)
## 游戏指南
- 界面设计<br>
![](https://github.com/fangweihao123/Photo-Repo/raw/master/gol_2.png)
<br>在界面中，黑色部分就表示该地区没有细胞的存在，细胞都处于死亡状态。0字符表示区域存在声明。
- 操作指南
可以从最后一行的指南中看出，按下方向键就可以改变光标的位置，M键使光标所在的区域产生生命，R键使光标所在行的所有区域都产生生命，C键使光标所在列所有区域都产生生命。Enter就是开始生命产生的游戏，Exit就是停止生命游戏。
- 运行环境
运行环境Windows32位系统，编译环境masm
## 程序结构及代码实现
![](https://github.com/fangweihao123/Photo-Repo/raw/master/gol_3.png)
##### 分为四个模块，一个使UI模块，matrix处理模块，计算模块，中断模块。
##### UI模块主要使对显存的操作，计算模块则是使用计算的指令。
##### 最核心的就是矩阵的处理模块，一共存在两个矩阵，一个使matrix，就是记录细胞目前的生存状态，另外一个使matrixstate,记录的是矩阵的下一时期变化状态。每一次更新，matrixstate根据matrix计算出下一时期的变化状态，再把下一时期的状态迁移到这一个状态，表示时间的进行，重复进行就表示了生命的演进。
##### GenerateState函数
![](https://github.com/fangweihao123/Photo-Repo/raw/master/gol_4.png)
##### UpdateMatrix函数
![](https://github.com/fangweihao123/Photo-Repo/raw/master/gol_5.png)
##### Judge函数
![](https://github.com/fangweihao123/Photo-Repo/raw/master/gol_6.png)
## 个人心得
##### 在开发过程中，踩了很多坑。但是确实，老师上课说的很多东西对于开发来说确实很有用。多文件使整个系统层次更加清晰，分模块使程序逻辑更加清晰。但是由于个人对于中断的理解不是很深入，在程序中使用中断的时候踩了很多的坑。比如在时钟中断返回之前需要加上如下的代码，    使用8259A芯片从中断发回
#####  mov al,20h          ; AL = EOI  
#####     out 20h,al          ; 发送EOI到主8529A  
#####     out 0A0h,al         ; 发送EOI到从8529A 
##### 不然就会产生卡死现象。其次在中断里面调用子过程的话一定要注意返回，不返回会导致栈寄存器的混乱，中断返回的地址也会出现错误。
## 思考改进
##### 整个程序还是在320*200的彩色显示模式下展示的，但是Game of life的标准情况都是无限大的区域，确实，这一点用汇编语言非常难实现，汇编语言也不存在矩阵等可用的数据结构。下一步的改进的话就是希望能换一个用户体验更好的显示模式，使这个游戏展示出更好的效果，以及加强游戏的可扩展性。
